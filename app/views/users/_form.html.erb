<%= form_with model: @user, local: true, multipart: true, class: "bg-white shadow-lg rounded-2xl p-12 w-full max-w-full mx-auto" do |f| %>
<h2 class="text-3xl font-bold text-slate-800 mb-8 text-center">ðŸ‘¤ Sign Up</h2>

<% if @user.errors.any? %>
<div class="mb-6 p-4 border border-red-300 bg-red-50 rounded-lg">
  <h3 class="text-red-700 font-semibold mb-2">
    <%= pluralize(@user.errors.count, "error") %> prohibited this user from being saved:
  </h3>
  <ul class="list-disc list-inside text-red-700">
    <% @user.errors.full_messages.each do |msg| %>
    <li><%= msg %></li>
    <% end %>
  </ul>
</div>
<% end %>

<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
  <!-- Name -->
  <div class="relative">
    <i class="fas fa-user absolute left-3 top-3 text-gray-400 mt-8"></i>
    <%= f.label :name, class: "block text-gray-700 font-medium mb-1" %>
    <%= f.text_field :name, class: "w-full pl-10 px-3 py-3 border rounded-lg focus:ring-2 focus:ring-purple-400 focus:border-transparent outline-none transition" %>
  </div>

  <!-- Email -->
  <div class="relative">
    <i class="fas fa-envelope absolute left-3 top-3 text-gray-400 mt-8"></i>
    <%= f.label :email, class: "block text-gray-700 font-medium mb-1" %>
    <%= f.email_field :email, class: "w-full pl-10 px-3 py-3 border rounded-lg focus:ring-2 focus:ring-purple-400 focus:border-transparent outline-none transition" %>
  </div>

  <!-- Password -->
  <div class="relative">
    <i class="fas fa-lock absolute left-3 top-3 text-gray-400 mt-8"></i>
    <%= f.label :password, (@user.new_record? ? "Password" : "Password (leave blank if unchanged)"), class: "block text-gray-700 font-medium mb-1" %>
    <%= f.password_field :password, class: "w-full pl-10 px-3 py-3 border rounded-lg focus:ring-2 focus:ring-purple-400 focus:border-transparent outline-none transition" %>
  </div>

  <!-- Password Confirmation -->
  <div class="relative">
    <i class="fas fa-lock absolute left-3 top-3 text-gray-400 mt-8"></i>
    <%= f.label :password_confirmation, class: "block text-gray-700 font-medium mb-1" %>
    <%= f.password_field :password_confirmation, class: "w-full pl-10 px-3 py-3 border rounded-lg focus:ring-2 focus:ring-purple-400 focus:border-transparent outline-none transition" %>
  </div>

  <!-- Profile Picture Upload -->
  <div class="md:col-span-2">
    <%= f.label :profile_image, "Profile Picture", class: "block text-gray-700 font-medium mb-2" %>
    <div class="flex items-center gap-4">
      <%= f.file_field :profile_image, class: "w-full px-3 py-3 border rounded-lg focus:ring-2 focus:ring-purple-400 focus:border-transparent outline-none transition", accept: "image/*", onchange: "loadPreview(event)" %>
      <!-- Preview -->
      <div class="w-24 h-24 bg-gray-200 rounded-full overflow-hidden">
        <img id="profile-preview" class="w-full h-full object-cover" src="<%= @user.profile_image.attached? ? url_for(@user.profile_image) : '' %>" alt="Preview">
      </div>
    </div>
  </div>

  <!-- Submit Button -->
  <div class="md:col-span-2 flex justify-center mt-8">
    <%= f.submit (@user.new_record? ? "Create User" : "Update User"), 
      class: "bg-purple-600 hover:bg-purple-700 text-white px-10 py-3 rounded-2xl font-semibold text-lg shadow-lg transition transform hover:-translate-y-1" %>
  </div>
  <% end %>

  <script>
    function loadPreview(event) {
      const output = document.getElementById('profile-preview');
      output.src = URL.createObjectURL(event.target.files[0]);
    }
  </script>